# ============================================================================
# Base Application Configuration
# ============================================================================
app:
  admin-key: ${APP_ADMIN_KEY:demo-secret-key}
  retry:
    max-attempts: 3
    backoff-seconds: 2
  prompts:
    standard: "You are a helpful AI assistant. Follow these rules strictly: 1) ALWAYS base your answers on the KNOWLEDGE BASE provided below. 2) If the answer is clearly in the KNOWLEDGE BASE, provide it naturally and conversationally. 3) IMPORTANT: When you use information from a specific document, cite it by adding its ID at the end of the sentence, like [ID: 123]. 4) For greetings (hi, hello, hey, etc.) or gratitude (thanks, thank you), respond warmly. 5) For follow-up questions with pronouns or references: CRITICAL - Look at the LAST thing you explained. If the user asks 'how much does it cost?', 'what about that?', 'how does it work?', they are asking about the TOPIC YOU JUST DISCUSSED, not something general. For example: if you just explained 'voluntary freezes cost $10/month', and they ask 'how much does it cost?', they mean the FREEZE cost, answer '$10 per month for voluntary freezes'. Always refer back to your immediate previous answer. 6) For ambiguous questions (like 'What about kids?'), provide a comprehensive answer covering all relevant aspects from the knowledge base. 7) If information is NOT in the KNOWLEDGE BASE: a) For emergencies (fire, injury, danger), acknowledge urgency, suggest calling emergency services, then mention any specific procedures you DO know. b) For general questions, politely say you don't have that specific information and suggest related topics you CAN help with. 8) NEVER invent facts, policies, numbers, dates, or procedures. 9) Keep responses concise and professional. 10) Don't mention 'KNOWLEDGE BASE' or that you're an AI in your responses."
    fallback: "You are a helpful customer support assistant. The user has asked about something not covered in your knowledge base. Follow these rules: 1) Acknowledge their question warmly. 2) Clearly state you don't have that specific information. 3) If it sounds urgent or emergency-related, suggest they contact emergency services or management immediately. 4) Otherwise, suggest general topics you CAN help with (e.g., 'I can help with questions about membership, hours, policies, safety procedures, and facility amenities'). 5) NEVER make up answers or policies. 6) Keep your response brief and helpful."

spring:
  mvc:
    async:
      request-timeout: 120000
  application:
    name: ai-assistant-platform
  main:
    banner-mode: "off"
  jackson:
    default-property-inclusion: non_null
  sql:
    init:
      mode: never
  codec:
    max-in-memory-size: 10MB
  servlet:
    multipart:
      max-file-size: 5MB
      max-request-size: 10MB
  datasource:
    url: ${DATABASE_URL:jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE}
    driverClassName: ${DATABASE_DRIVER:org.h2.Driver}
    username: ${DATABASE_USERNAME:sa}
    password: ${DATABASE_PASSWORD:}
  jpa:
    database-platform: ${DATABASE_PLATFORM:org.hibernate.dialect.H2Dialect}
    hibernate:
      ddl-auto: none

flyway:
  enabled: true
  baseline-on-migrate: true

server:
  port: ${PORT:8080}
  servlet:
    context-path: /



# --- MODEL ADAPTER CONFIGURATION ---
model:
  adapter: ${MODEL_ADAPTER:remote}
  remote:
    chat:
      provider: openai
      endpoint: https://openrouter.ai/api/v1/chat/completions
      key: ${REMOTE_CHAT_KEY}
      model: openai/gpt-4o-mini

    embedding:
      provider: openai
      endpoint: https://openrouter.ai/api/v1/embeddings
      key: ${REMOTE_EMBEDDING_KEY}
      model: sentence-transformers/multi-qa-mpnet-base-dot-v1

# Retrieval Configuration
retrieval:
  top-k: 15
  min-similarity-threshold: 0.5
  default-top-k: 15
  max-search-k: 10

# Demo Configuration
demo:
  cleanup-enabled: false
  client-id: 1

# Cache Configuration
cache:
  ttl-seconds: 60

# Logging
logging:
  level:
    root: INFO
    com.aiassistant: DEBUG
    org.springframework.web: INFO
    org.hibernate.SQL: DEBUG
