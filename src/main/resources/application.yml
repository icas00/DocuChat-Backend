# ============================================================================
# Base Application Configuration
# ============================================================================
app:
  admin-key: ${APP_ADMIN_KEY:demo-secret-key}
  retry:
    max-attempts: 3
    backoff-seconds: 2
  prompts:
    standard: "You are a helpful AI assistant. Follow these rules strictly: 1) ALWAYS base your answers on the KNOWLEDGE BASE provided below. 2) If the answer is clearly in the KNOWLEDGE BASE, provide it naturally and conversationally. 3) For greetings (hi, hello, hey, etc.), respond warmly and ask how you can help. 4) For follow-up questions, use the conversation HISTORY to understand context - if the previous answer mentioned someone or something, you can reference it. 5) If information is NOT in the KNOWLEDGE BASE: a) For emergencies (fire, injury, danger), acknowledge the urgency and suggest calling emergency services (police/fire/medical), then say you don't have specific company procedures. b) For general questions, politely say you don't have that specific information and suggest related topics you CAN help with from the knowledge base. 6) NEVER invent facts, policies, numbers, dates, or procedures. 7) Keep responses concise and professional. 8) Don't mention 'KNOWLEDGE BASE' or that you're an AI in your responses."
    fallback: "You are a helpful customer support assistant. The user has asked about something not covered in your knowledge base. Follow these rules: 1) Acknowledge their question warmly. 2) Clearly state you don't have that specific information. 3) If it sounds urgent or emergency-related, suggest they contact emergency services or management immediately. 4) Otherwise, suggest general topics you CAN help with (e.g., 'I can help with questions about payroll, PTO, equipment usage, or safety procedures'). 5) NEVER make up answers or policies. 6) Keep your response brief and helpful."

spring:
  application:
    name: ai-assistant-platform
  main:
    banner-mode: "off"
  jackson:
    default-property-inclusion: non_null
  sql:
    init:
      mode: never
  codec:
    max-in-memory-size: 10MB
  servlet:
    multipart:
      max-file-size: 5MB
      max-request-size: 10MB
  datasource:
    url: ${DATABASE_URL:jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE}
    driverClassName: ${DATABASE_DRIVER:org.h2.Driver}
    username: ${DATABASE_USERNAME:sa}
    password: ${DATABASE_PASSWORD:}
  jpa:
    database-platform: ${DATABASE_PLATFORM:org.hibernate.dialect.H2Dialect}
    hibernate:
      ddl-auto: none

flyway:
  enabled: true
  baseline-on-migrate: true

server:
  port: ${PORT:8080}

# --- MODEL ADAPTER CONFIGURATION ---
model:
  adapter: ${MODEL_ADAPTER:remote}
  remote:
    chat:
      provider: openai
      endpoint: https://openrouter.ai/api/v1/chat/completions
      key: ${REMOTE_CHAT_KEY}
      model: openai/gpt-4o-mini

    embedding:
      provider: openai
      endpoint: https://openrouter.ai/api/v1/embeddings
      key: ${REMOTE_EMBEDDING_KEY}
      model: sentence-transformers/multi-qa-mpnet-base-dot-v1

# Retrieval Configuration
retrieval:
  top-k: 15
  min-similarity-threshold: 0.5

# Cache Configuration
cache:
  ttl-seconds: 60

# Logging
logging:
  level:
    root: INFO
    com.aiassistant: DEBUG
    org.springframework.web: INFO
    org.hibernate.SQL: DEBUG
